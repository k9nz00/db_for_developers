### Задание 1

1. Объясните, что произойдёт, если СУБД получит запрос на выборку большой таблицы?
2. Что произойдёт, если на сервере СУБД недостаточно оперативной памяти, чтобы загрузить в неё все данные таблицы?

Ответ:

1. Данные таблиц в СУБД хранятся в страницах памяти. Размер страниц памяти от 4 до 64 кб. В случае если СУБД получит
   запрос на выборку большой таблицы будет произведено сканирование страниц памяти, для определения подходящих страниц,
   и затем будут выбраны сами данные.

2. Ничего плохого, так как СУБД загружает данные частями (страницами). При исчерпании доступного объема памяти некоторые
   данные будут сброшены на диск (spills)

### Задание 2

Для следующих задач укажите наиболее подходящие структуры данных для использования в индексах.

1. Составление отчёта по оказанным услугам, данные в котором агрегируются за каждый месяц.
2. Есть таблица с бинарными признаками, её заполняет нейросеть. Задача состоит в том, чтобы быстро выбирать объекты с
   определённым набором признаков.
3. Для системы контроля доступа нужно выбирать пользователя по идентификатору его пропуска.
4. Для системы каршеринга нужно выбирать ближайшие к пользователю свободные машины.

Ответы:

1. btree
2. bitmap
3. hash
4. GiST

### Задание 3

Запрос:

```sql
SELECT u.login, SUM(LENGTH(m.message_text)) AS total_length
FROM user u
         JOIN user_private_message m ON m.user_from_id = u.user_id
GROUP BY u.login;

```

Укажите, какие ключи каких таблиц может использовать СУБД, руководствуясь своим планом выполнения запроса.

Ответ:

1. Для таблицы user_private_message возможно использование ключа 'user_from_id', но в приведенном примере он не
   используется, о чем говорит пустая колонка key плана запроса
2. Для таблицы user возможно использование ключей 'PRIMARY' и 'login'.

### Задание 4

В таблице есть несколько индексов, которые замедляют выборку данных вместо ускорения.

1. Почему это может происходить?
2. Что в этом случае можно сделать, если удалить индексы пока нет возможности?

Ответ:

1. Замедление может просходить по причине слишком больщого количества примененных индексов (на каждое поле). И из-за
   необходимости дополнительных операций сканирования происходит снижение скорости выборки
2. При невозможности удаления лишних индексов необходимо использовать хинты для СУБД, смысл которых будет заключаться в
   том, что СУБД получит дополнительные подсказки о необходимости использования или неиспользования индексов